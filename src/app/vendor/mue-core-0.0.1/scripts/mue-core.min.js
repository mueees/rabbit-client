!function(){angular.module("mue.core.auth-account",["mue.core.security","mue.core.resources"])}(),function(){angular.module("mue.core.auth-proxy",["mue.core.security"])}(),function(){angular.module("mue.core.components.date-switcher",["mue.core.components.date-viewer"])}(),function(){angular.module("mue.core.components.date-viewer",[])}(),function(){angular.module("mue.core.components.header",["mue.core.auth-proxy"])}(),function(){angular.module("mue.core.components.helpers",[])}(),function(){angular.module("mue.core.components.list-group",[])}(),function(){angular.module("mue.core.components.login",["mue.core.auth-proxy"])}(),function(){angular.module("mue.core.components.seed",[])}(),function(){angular.module("mue.core.components.sidebar",[])}(),function(){angular.module("mue.core.error-handler",["angular-growl"])}(),function(){angular.module("mue.helpers",[])}(),function(){angular.module("mue.core.modal",[])}(),function(){"use strict";angular.module("mue.core.resources",["restangular"])}(),function(){"use strict";angular.module("mue.core.security",["ui.router","mue.core.resources"])}(),function(){"use strict";angular.module("mue.core.error-handler").config(["$provide","$httpProvider",function(a,b){a.decorator("$exceptionHandler",["$delegate","$injector",function(a,b){return function(c,d){b.get("mueScriptErrorHandler").handleScriptError(c,d),a(c,d)}}])}])}(),function(){"use strict";angular.module("mue.core.security").config(["$httpProvider",function(a){a.interceptors.push(["$rootScope","$q","MUE_AUTH_EVENTS",function(a,b,c){return{responseError:function(d){return a.$broadcast({401:c.notAuthenticated,403:c.notAuthorized}[d.status]),b.reject(d)}}}])}])}(),function(){"use strict";angular.module("mue.core.error-handler").constant("MUE_ERROR_MESSAGES",{httpDefaultError:"An unexpected server communication error has occurred. Status: ",httpNetworkError:"Network communication error has occurred.",scriptError:"An unexpected script error has occurred."})}(),function(){"use strict";angular.module("mue.core.security").constant("MUE_AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",logoutFailed:"auth-logout-failed",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"})}(),function(){"use strict";angular.module("mue.core.auth-account").factory("mueAuthAccount",["$q","$rootScope","MUE_AUTH_EVENTS","AuthAccountResource",function(a,b,c,d){function e(a){return d.login(a).then(function(a){a.client_token=a.token,b.$broadcast(c.loginSuccess,a)})}function f(){b.$broadcast(c.logoutSuccess)}return{login:e,logout:f}}])}(),function(){"use strict";angular.module("mue.core.auth-proxy").provider("mueAuthProxy",function(){function a(a){c=a}function b(a){a=a||{},a.origin&&(e=a.origin,f=e+"/provide/")}var c=null,d=12e4,e="http://proxy.mue.in.ua",f="http://proxy.mue.in.ua/provide/";return{setOauthKey:a,config:b,$get:["$q","$rootScope","MUE_AUTH_EVENTS",function(a,b,g){function h(){this.timeout=6e4,this.initialize()}function i(){(new h).open().then(function(a){b.$broadcast(g.loginSuccess,a)})}function j(){b.$broadcast(g.logoutSuccess)}if(h.prototype={initialize:function(){},open:function(){var b=this;return this.defer=a.defer(),this.window=window.open(f+c),window.addEventListener("message",function(a){b.receiveMessage(a)},!1),this.openTimeout=setTimeout(function(){b.reject("Timeout")},d),this.openInterval=setInterval(function(){b.window.postMessage({origin:window.location.origin,host:window.location.host,href:window.location.href},"*")},500),this.windowClosedInterval=setInterval(function(){b.window.closed&&b.reject("Window was closed")},1e3),this.defer.promise},reject:function(a){this.clearOpenInterval(),this.clearWindowClosedInterval(),this.clearOpenTimeout(),this.unSubscribeMessage(),this.defer.reject({status:500,message:a||"Server error"})},unSubscribeMessage:function(){window.removeEventListener("message",this.receiveMessage,!1)},clearWindowClosedInterval:function(){clearInterval(this.windowClosedInterval)},clearOpenInterval:function(){this.openInterval&&(clearInterval(this.openInterval),this.openInterval=null)},clearOpenTimeout:function(){this.openTimeout&&(clearTimeout(this.openTimeout),this.openTimeout=null)},receiveMessage:function(a){if(a.origin==e){this.clearOpenInterval(),this.clearOpenTimeout(),this.unSubscribeMessage();var b=JSON.parse(a.data);200==b.status?this.defer.resolve(b):this.defer.reject(b)}}},!c)throw new Error("mueAuthUserResource service has not been configured properly.");return{login:i,logout:j}}]}})}(),function(){angular.module("mue.core.error-handler").factory("mueScriptErrorHandler",["growl","MUE_ERROR_MESSAGES",function(a,b){function c(c,d){var e=b.scriptError;_.isString(c.message)&&(e+=" "+c.message),a.addErrorMessage(e)}return{handleScriptError:c}}])}(),function(){angular.module("mue.core.error-handler").factory("mueHttpResponseErrorInterceptor",["$q","mueServerErrorHandler",function(a,b){return{responseError:function(c){return b.handleServerResponseError(c),a.reject(c)}}}])}(),function(){angular.module("mue.core.error-handler").factory("mueServerErrorHandler",["growl","MUE_ERROR_MESSAGES",function(a,b){function c(a){var c=e(a);if(!c)if(0===a.status)c=b.httpNetworkError;else{var f=a.status||"";a.statusText&&(f+=" "+a.statusText),c=b.httpDefaultError+f}d(c)}function d(b){a.addErrorMessage(_.trunc(b,500))}function e(a){return a&&a.data&&_.isString(a.data.message)?a.data.message:void 0}return{handleServerResponseError:c}}])}(),function(){angular.module("mue.helpers").factory("mueHelpers",function(){return{guid:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}}})}(),function(){angular.module("mue.core.modal").factory("ConfirmModal",["$modal",function(a){function b(b){return a.open({templateUrl:"src/core/modal/confirm-modal.view.html",controller:"ConfirmModalController",resolve:{data:function(){return b}}})}return{open:b}}])}(),function(){"use strict";angular.module("mue.core.resources").provider("MueResource",function(){var a="http://proxy.mue.in.ua/api";return{setBaseUrl:function(b){b&&(a=b)},$get:["Restangular",function(b){return b.withConfig(function(b){b.setBaseUrl(a)})}]}})}(),function(){"use strict";angular.module("mue.core.security").provider("mueAuthentication",function(){function a(a,b){return arguments.length&&(c={name:a,params:b}),c}function b(a,b){return arguments.length&&(_.isString(a)?d={name:a,params:b}:_.isFunction(a)?d=a:_.isObject(a)&&_.isString(a.name)&&(d=a)),d}var c=null,d=null;return{loginState:a,appState:b,$get:["$state","$rootScope","$q","MueUserResource","MueResource","mueSession","mueToken","MUE_AUTH_EVENTS",function(a,b,e,f,g,h,i,j){function k(){var a=e.defer();return h.isAlive()?a.resolve():f.getCurrentUser().then(function(b){h.create(b),a.resolve()}),a.promise}function l(b,c){i.create(c.client_token);var e=o;_.isFunction(e)&&(e=e()),_.isString(e)&&(e={name:e}),a.go(e.name,e.params),o=d}function m(){a.go(c.name,c.params)}function n(){i.destroy(),h.destroy(),o=d,m()}if(!c||!c.name||!d)throw new Error("mueAuthentication service has not been configured properly.");var o=d;return b.$on("$stateChangeStart",function(a,b,d){b&&b.name!==c.name&&(o={name:b.name,params:d})}),b.$on(j.notAuthenticated,function(){h.destroy(),m()}),b.$on(j.loginSuccess,l),b.$on(j.logoutSuccess,n),b.$on(j.logoutFailed,n),g.addFullRequestInterceptor(function(a,b,c,d,e,f,g){return i.hasToken()&&(e.Authorization="Bearer "+i.getToken()),{element:a,params:f,headers:e,httpConfig:g}}),{initSession:k}}]}})}(),function(){"use strict";angular.module("mue.core.security").factory("mueSession",function(){function a(a){e=a}function b(){e=null}function c(){return e}function d(){return null!==e}var e=null;return{create:a,destroy:b,getUser:c,isAlive:d}})}(),function(){"use strict";angular.module("mue.core.security").factory("mueToken",function(){function a(a){localStorage.setItem(e,a)}function b(){localStorage.setItem(e,"")}function c(){return localStorage.getItem(e)}function d(){return Boolean(localStorage.getItem(e))}var e="mueToken";return{create:a,destroy:b,getToken:c,hasToken:d}})}(),angular.module("mue.core.components.date-switcher").directive("mueDateSwitcher",function(){return{restrict:"E",templateUrl:"scripts/components/date-switcher/date-switcher.directive.html",scope:{mueConfig:"="},link:function(a,b){function c(){return Math.floor((a.mueConfig.end-a.mueConfig.start)/864e5)}a.today=function(){switch(a.mueConfig.type){case 1:a.mueConfig.start=new Date;break;case 2:var b=c();a.mueConfig.start=new Date,a.mueConfig.end=moment(new Date).add(b,"d").toDate()}},a.prev=function(){var b=c();switch(a.mueConfig.type){case 1:a.mueConfig.start=moment(a.mueConfig.start).add(-1,"d").toDate();break;case 2:a.mueConfig.start=moment(a.mueConfig.start).add(-b,"d").toDate(),a.mueConfig.end=moment(a.mueConfig.end).add(-b,"d").toDate()}},a.next=function(){var b=c();switch(a.mueConfig.type){case 1:a.mueConfig.start=moment(a.mueConfig.start).add(1,"d").toDate();break;case 2:a.mueConfig.start=moment(a.mueConfig.start).add(b,"d").toDate(),a.mueConfig.end=moment(a.mueConfig.end).add(b,"d").toDate()}},a.isDisabled=function(){var b=!0,c=moment(a.mueConfig.start);switch(a.mueConfig.type){case 1:b=c.format("DD")==moment(new Date).format("DD");break;case 2:b=c.format("DD")==moment(new Date).format("DD")}return b},a.dateViewerConfiguration=a.mueConfig}}}),angular.module("mue.core.components.date-viewer").directive("mueDateViewer",function(){return{restrict:"E",templateUrl:"scripts/components/date-viewer/date-viewer.directive.html",scope:{mueConfig:"="},link:function(a,b){}}}),angular.module("mue.core.components.header").directive("mueHeader",function(){return{restrict:"E",templateUrl:"scripts/components/header/header.directive.html",scope:{mueConfig:"="},link:function(a){}}}),function(){angular.module("mue.core.components.helpers").directive("clearText",function(){return{restrict:"A",link:function(a,b){var c=b[0].querySelectorAll("br");_.each(c,function(a){a.remove()})}}})}(),function(){angular.module("mue.core.components.helpers").directive("deviceHeight",["$window","$timeout",function(a,b){return{restrict:"A",link:function(b,c){c.css("height",a.innerHeight+"px"),angular.element(a).bind("resize",function(){c.css("height",a.innerHeight+"px")})}}}])}(),function(){angular.module("mue.core.components.helpers").directive("fallbackImg",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){function e(){d.fallbackImg?c.attr("src",d.fallbackImg):c.remove()}a(function(){c.attr("src")?c.bind("error",function(){e()}):e()})}}}])}(),angular.module("mue.core.components.list-group").directive("mueListGroup",function(){return{restrict:"E",templateUrl:"scripts/components/list-group/list-group.directive.html",scope:{mueConfig:"="}}}),angular.module("mue.core.components.login").directive("mueLogin",["mueAuthProxy",function(a){return{restrict:"E",templateUrl:"scripts/components/login/login.directive.html",scope:{mueConfig:"="},link:function(b){b.login=a.login}}}]),angular.module("mue.core.components.seed").directive("mueSeed",function(){return{restrict:"E",templateUrl:"scripts/components/seed/seed.directive.html"}}),angular.module("mue.core.components.sidebar").directive("mueSidebar",["$rootScope",function(a){return{restrict:"E",transclude:!0,scope:{mueConfig:"="},templateUrl:"scripts/components/sidebar/sidebar.directive.html",link:function(b,c){b.open=function(){b.isOpen=!0,c.addClass("mue-sidebar-open")},b.close=function(){b.isOpen=!1,c.removeClass("mue-sidebar-open")},a.$on("mueSidebar:close",b.close)}}}]),function(){angular.module("mue.core.modal").controller("ConfirmModalController",["$scope","$modalInstance","data",function(a,b,c){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")},_.extend(a,c)}])}(),function(){"use strict";angular.module("mue.core.resources").factory("AuthAccountResource",["$q","MueResource",function(a,b){var c=b.withConfig(function(a){});return{login:function(a){return c.all("/sign").post(a)}}}])}(),function(){"use strict";angular.module("mue.core.resources").factory("MueUserResource",["$q","MueResource",function(a,b){var c=b.one("account/user");return{getCurrentUser:function(){return c.get()}}}])}(),function(){angular.module("mue.helpers").run(["$templateCache",function(a){"use strict";a.put("scripts/components/date-switcher/date-switcher.directive.html",'<button class="btn btn-lagoon mue-date-switcher-today" ng-click="today()" ng-disabled="isDisabled()">Today</button><div class="btn-group mue-date-switcher-navigation"><button type="button" class="btn btn-lagoon" ng-click="prev()">&lt;</button> <button type="button" class="btn btn-lagoon" ng-click="next()">&gt;</button></div><mue-date-viewer mue-config="dateViewerConfiguration"></mue-date-viewer>'),a.put("scripts/components/date-viewer/date-viewer.directive.html","<div ng-switch=\"mueConfig.type\"><span ng-switch-when=\"1\">{{mueConfig.start | date:'dd MMMM yyyy'}}</span> <span ng-switch-when=\"2\">{{mueConfig.start | date:'dd MMMM'}} - {{mueConfig.end | date:'dd MMMM'}}, {{mueConfig.end | date:'yyyy'}}</span></div>"),a.put("scripts/components/header/header.directive.html",'<div class="mue-brand">{{mueConfig.name}}</div><ul class="mue-nav mue-header-menu pull-right"><li>{{mueConfig.email}}</li><li><a href="" ng-click="logoutHandler()">Logout</a></li></ul>'),a.put("scripts/components/list-group/list-group.directive.html",'<div class="list-group mue-list-group" ng-class="{\'mue-list-group-flat\': mueConfig.ui.flat, \'mue-list-group-dark\': mueConfig.ui.dark}"><div ng-click="mueConfig.clickHandler(item)" ng-class="{active: item.active}" ng-repeat="item in mueConfig.items" class="list-group-item list-group-item-lagoon"><div class="pull-left"><i class="fa fa-{{item.icon}} mue-icon"></i></div><div class="pull-right"><button ng-click="action.handler(item)" ng-repeat="action in item.actions" class="btn btn-clear"><i class="fa fa-{{action.icon}} mue-icon"></i></button></div><div class="mue-list-group-content">{{item.text}}</div></div></div>'),a.put("scripts/components/login/login.directive.html",'<div class="panel mue-panel mue-card mue-card-lagoon"><div class="panel-body"><div class="mue-card-icon"><i class="fa fa-calendar mue-icon"></i></div><h4 class="mue-card-title">{{mueConfig.name || \'New Application\'}}</h4><div class="mue-card-description" ng-if="mueConfig.description">{{mueConfig.description}}</div><button ng-click="login()" class="btn btn-action btn-strawberry btn-block">{{mueConfig.action || \'Login\'}}</button></div></div>'),a.put("scripts/components/seed/seed.directive.html","Seed directive"),a.put("scripts/components/sidebar/sidebar.directive.html",'<div class="mue-sidebar-navs"><button class="btn btn-lg mue-sidebar-navs-open" ng-if="!isOpen" ng-click="open()"><i class="fa fa-th-large mue-icon"></i></button> <button class="btn btn-lg btn-clear mue-sidebar-navs-close" ng-if="isOpen" ng-click="close()"><i class="fa fa-close mue-icon"></i></button></div><div class="mue-sidebar-content" ng-transclude></div>'),a.put("scripts/modal/confirm-modal.view.html",'<div class="modal-header"><button type="button" class="close"><span>X</span></button><h4 class="modal-title">Confirm</h4></div><div class="modal-body">{{text}}</div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="cancel()">{{decline}}</button> <button type="button" class="btn btn-lagoon btn-action" ng-click="ok()">{{accept}}</button></div>')}])}();
//# sourceMappingURL=mue-core.min.js.map